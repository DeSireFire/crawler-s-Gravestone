import { defineStore } from "pinia";
import { useStateStorage } from "~/utils/cache";

interface ObjectList {
  [key: string]: string[];
}

const { useJsonStorage } = useStateStorage();

export const usePermissStore = defineStore("permiss", {
  state: () => ({
    // 用户权限列表缓存到 localstorage 的 ms_keys 中
    key: useJsonStorage<string[]>("ms_keys", ["66"]),
    // 个位数为大功能编号
    // 多位数代指从属关系，如 1 11、12、13 意思说11,12,13属于1号模块
    defaultList: <ObjectList>{
      xadmin: [
        "1","11","12","13","14","15","16","17","18","19",
        "2","21","22","23","24","25","26","27","28","29",
        "3","31","32","33","34","35","36","37","38","39",
        "4","41","42","43","44","45","46","47","48","49",
        "5","51","52","53","54","55","56","57","58","59",
        "6","61","62","63","64","65","66","67","68","69",
        "7","71","72","73","74","75","76","77","78","79",
        "8","81","82","83","84","85","86","87","88","89",
        "9","91","92","93","94","95","96","97","98","99",
      ],
      admin: [
        "1","11","12","13","14","15","16","17","18","19",
        "2","21","22","23","24","25","26","27","28","29",
        "3","31","32","33","34","35","36","37","38","39",
        "4","41","42","43","44","45","46","47","48","49",
        "5","51","52","53","54","55","56","57","58","59",
        "6","61","62","63","64","65","66","67","68","69",
        "7","71","72","73","74","75","76","77","78","79",
        "8","81","82","83","84","85","86","87","88","89",
        "9","91","92","93","94","95","96","97","98","99",
      ],
      coder: [
        "1","11","12","13","14","15","16","17","18","19",
        "2","21","22","23","24","25","26","27","28","29",
        "3","31","32","33","34","35","36","37","38","39",
        "4","41","42","43","44","45","46","47","48","49",
        "5","51","52","53","54","55","56","57","58","59",
        "6","61","62","63","64","65","66","67","68","69",
        "7","71","72","73","74","75","76","77","78","79",
        "8","81","82","83","84","85","86","87","88","89",
        "9","91","92","93","94","95","96","97","98","99",
      ],
      normal: [
        "1","11","12","13","14","15","16","17","18","19",
        "2","21","22","23","24","25","26","27","28","29",
        "3","31","32","33","34","35","36","37","38","39",
        "4","41","42","43","44","45","46","47","48","49",
        "5","51","52","53","54","55","56","57","58","59",
        "6","61","62","63","64","65","66","67","68","69",
        "7","71","72","73","74","75","76","77","78","79",
        "8","81","82","83","84","85","86","87","88","89",
        "9","91","92","93","94","95","96","97","98","99",
      ],
      default: [
        "1",
      ],
    },
  }),
  actions: {
    handleSet(val: string[]) {
      this.key = val;
      // console.log(this.key, val)
    },
  },
});

// export const usePermissStore = defineStore('permiss', {
//   state: () => {
//     const keys = localStorage.getItem('ms_keys');
//     return {
//       key: keys ? JSON.parse(keys) : <string[]>[],
//       defaultList: <ObjectList>{
//       admin: [
//         "1","11","12","13","14","15","16","17","18","19",
//         "2","21","22","23","24","25","26","27","28","29",
//         "3","31","32","33","34","35","36","37","38","39",
//         "4","41","42","43","44","45","46","47","48","49",
//         "5","51","52","53","54","55","56","57","58","59",
//         "6","61","62","63","64","65","66","67","68","69",
//         "7","71","72","73","74","75","76","77","78","79",
//         "8","81","82","83","84","85","86","87","88","89",
//         "9","91","92","93","94","95","96","97","98","99",
//       ],
//         normal: ['1', '2', '3']
//       }
//     };
//   },
//   actions: {
//     handleSet(val: string[]) {
//       this.key = val;
//     }
//   }
// });
